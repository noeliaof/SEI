<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get drought characteristics — get_drought • SEI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get drought characteristics — get_drought"><meta name="description" content="Extract characteristics of droughts from a time series of values. Drought characteristics
include the occurrence, intensity, magnitude, and duration of the drought."><meta property="og:description" content="Extract characteristics of droughts from a time series of values. Drought characteristics
include the occurrence, intensity, magnitude, and duration of the drought."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SEI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="external-link dropdown-item" href="https://doi.org/10.31223/X5GM4G">Standardised Indices-SEI</a></li>
    <li><a class="external-link dropdown-item" href="https://doi.org/10.1016/j.renene.2023.119206">Energy droughts</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/noeliaof/SEI"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get drought characteristics</h1>
      <small class="dont-index">Source: <a href="https://github.com/noeliaof/SEI/blob/main/R/get_drought.R" class="external-link"><code>R/get_drought.R</code></a></small>
      <div class="d-none name"><code>get_drought.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract characteristics of droughts from a time series of values. Drought characteristics
include the occurrence, intensity, magnitude, and duration of the drought.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_drought</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.28</span>, <span class="fl">1.64</span>, <span class="fl">1.96</span><span class="op">)</span>,</span>
<span>  exceed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>vector or xts object.</p></dd>


<dt id="arg-thresholds">thresholds<a class="anchor" aria-label="anchor" href="#arg-thresholds"></a></dt>
<dd><p>numeric vector containing thresholds to use when defining droughts.</p></dd>


<dt id="arg-exceed">exceed<a class="anchor" aria-label="anchor" href="#arg-exceed"></a></dt>
<dd><p>logical; TRUE if a drought is defined when <code>x</code> is above the thresholds, FALSE otherwise.</p></dd>


<dt id="arg-lag">lag<a class="anchor" aria-label="anchor" href="#arg-lag"></a></dt>
<dd><p>logical; TRUE if the drought should end when the value changes sign.</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>integer specifying the number of timesteps over which droughts should be clustered.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing the original values <code>x</code> and the corresponding drought characteristics.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A drought is assumed to be defined as an instance when the vector <code>x</code> exceeds
(if <code>exceed = TRUE</code>) or falls below (if <code>exceed = FALSE</code>) the specified
thresholds in <code>thresholds</code>.</p>
<p><code>thresholds</code> can be a single value, or a vector of values. In the latter case,
each threshold is assumed to be a different level or intensity of the drought.
For example, if <code>thresholds = c(1, 1.5, 2)</code>, then a level 1 drought occurs
whenever <code>x</code> exceeds 1 but is lower than 1.5, a level 2 drought occurs
whenever <code>x</code> exceeds 1.5 but is lower than 2, and a level 3 drought occurs
whenever <code>x</code> exceeds 2.</p>
<p>By default, <code>thresholds = c(1.28, 1.64, 1.96)</code>, which correspond to the
90th, 95th, and 97.5th percentiles of the standard normal distribution.</p>
<p>In meteorology, droughts are typically defined in terms of
standardised indices, such as the standardised precipitation index (SPI).
It is sometimes the case that a drought event ends not when the variable of
interest no longer exceeds (or falls below) the relevant thresholds, but rather
when the index changes sign. This can help to account for fluctuations around
the threshold values, classing it as one long drought rather than several shorter
droughts. This definition can be used by specifying <code>lag = TRUE</code>.</p>
<p><code>get_drought()</code> currently does not use the time series information in
the xts input, thereby assuming that the time series is complete, without missing
time periods. If <code>x</code> is a vector, rather than an xts object, then this
is also implicitly assumed.</p>
<p>The output is a dataframe containing the vector <code>x</code>, a logical vector
specifying whether each value of <code>x</code> corresponds to a drought event,
and the magnitude of the drought. The magnitude of the drought is only shown
on the last day of the drought. This makes it easier to compute statistics about
the drought magnitude, such as the average drought magnitude.
If <code>thresholds</code> is a vector, the intensity or level of the drought is also returned.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Allen, S. and N. Otero (2023):
`Standardised indices to monitor energy droughts',
<em>Renewable Energy</em>
<a href="https://doi.org/10.1016/j.renene.2023.119206" class="external-link">doi:10.1016/j.renene.2023.119206</a></p>
<p>McKee, T. B., Doesken, N. J., &amp; Kleist, J. (1993):
`The relationship of drought frequency and duration to time scales',
<em>In Proceedings of the 8th Conference on Applied Climatology</em> 17, 179-183.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sam Allen, Noelia Otero</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data_supply</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># consider hourly German energy supply data in 2019</span></span></span>
<span class="r-in"><span><span class="va">supply_de</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">data_supply</span>, <span class="va">country</span> <span class="op">==</span> <span class="st">"Germany"</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"PWS"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">supply_de</span> <span class="op">&lt;-</span> <span class="fu">xts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xts/man/xts.html" class="external-link">xts</a></span><span class="op">(</span><span class="va">supply_de</span><span class="op">$</span><span class="va">PWS</span>, order.by <span class="op">=</span> <span class="va">supply_de</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">supply_de_std</span> <span class="op">&lt;-</span> <span class="fu"><a href="std_index.html">std_index</a></span><span class="op">(</span><span class="va">supply_de</span>, timescale <span class="op">=</span> <span class="st">"hours"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">drought_df</span> <span class="op">&lt;-</span> <span class="fu">get_drought</span><span class="op">(</span><span class="va">supply_de_std</span>, thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, exceed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">drought_df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Index         x ins occ dur mag</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2019-01-01 00:00:00 0.6483216   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2019-01-01 01:00:00 0.7609253   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2019-01-01 02:00:00 0.9119604   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2019-01-01 03:00:00 1.0273229   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2019-01-01 04:00:00 1.1438592   0   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2019-01-01 05:00:00 1.2060405   0   0   0   0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sam Allen, Noelia Otero.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

