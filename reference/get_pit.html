<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate probability integral transform values — get_pit • SEI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate probability integral transform values — get_pit"><meta name="description" content="Function to estimate the cumulative distribution function (CDF)
from a set of observations, and return the corresponding probability integral
transform (PIT) values."><meta property="og:description" content="Function to estimate the cumulative distribution function (CDF)
from a set of observations, and return the corresponding probability integral
transform (PIT) values."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SEI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="external-link dropdown-item" href="https://doi.org/10.31223/X5GM4G">Calculating standardised indices using SEI</a></li>
    <li><a class="external-link dropdown-item" href="https://doi.org/10.1016/j.renene.2023.119206">Standardised indices to monitor energy droughts</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/noeliaof/SEI"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate probability integral transform values</h1>
      <small class="dont-index">Source: <a href="https://github.com/noeliaof/SEI/blob/main/R/get_pit.R" class="external-link"><code>R/get_pit.R</code></a></small>
      <div class="d-none name"><code>get_pit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to estimate the cumulative distribution function (CDF)
from a set of observations, and return the corresponding probability integral
transform (PIT) values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_pit</span><span class="op">(</span></span>
<span>  <span class="va">x_ref</span>,</span>
<span>  x_new <span class="op">=</span> <span class="va">x_ref</span>,</span>
<span>  dist <span class="op">=</span> <span class="st">"empirical"</span>,</span>
<span>  preds_ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preds_new <span class="op">=</span> <span class="va">preds_ref</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mle"</span>,</span>
<span>  return_fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  cens <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  n_thres <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-ref">x_ref<a class="anchor" aria-label="anchor" href="#arg-x-ref"></a></dt>
<dd><p>numeric vector from which to estimate the CDF.</p></dd>


<dt id="arg-x-new">x_new<a class="anchor" aria-label="anchor" href="#arg-x-new"></a></dt>
<dd><p>numeric vector from which to calculate the PIT values.</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>character string specifying the distribution to be fit to the data;
one of <code>'empirical'</code>, <code>'kde'</code>, <code>'norm'</code>, <code>'lnorm'</code>, <code>'logis'</code>, <code>'llogis'</code>,
<code>'exp'</code>, <code>'gamma'</code>, and <code>'weibull'</code>.</p></dd>


<dt id="arg-preds-ref">preds_ref<a class="anchor" aria-label="anchor" href="#arg-preds-ref"></a></dt>
<dd><p>data frame of predictor variables on which the estimated distribution
should depend, corresponding to the reference observations <code>x_ref</code>.</p></dd>


<dt id="arg-preds-new">preds_new<a class="anchor" aria-label="anchor" href="#arg-preds-new"></a></dt>
<dd><p>data frame of predictor variables on which the estimated distribution
should depend, corresponding to the new observations <code>x_new</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A character string coding for the fitting method:
    <code>"mle"</code> for 'maximum likelihood estimation', <code>"mme"</code> for 'moment matching estimation',
    <code>"qme"</code> for 'quantile matching estimation', <code>"mge"</code> for 'maximum goodness-of-fit estimation'
    and <code>"mse"</code> for 'maximum spacing estimation'.</p></dd>


<dt id="arg-return-fit">return_fit<a class="anchor" aria-label="anchor" href="#arg-return-fit"></a></dt>
<dd><p>logical specifying whether to return parameters and goodness-of-fit
statistics for the distribution fit.</p></dd>


<dt id="arg-lower-upper">lower, upper<a class="anchor" aria-label="anchor" href="#arg-lower-upper"></a></dt>
<dd><p>numeric values specifying the lower and upper bounds at which the
values in <code>x_ref</code> and <code>x_new</code> are censored.</p></dd>


<dt id="arg-cens">cens<a class="anchor" aria-label="anchor" href="#arg-cens"></a></dt>
<dd><p>method used to deal with censoring of the PIT values; either a string
(<code>'none'</code>, <code>'normal'</code> or <code>'prob'</code>), corresponding to common choices, or a custom numeric value.</p></dd>


<dt id="arg-n-thres">n_thres<a class="anchor" aria-label="anchor" href="#arg-n-thres"></a></dt>
<dd><p>minimum number of data points required to estimate the distribution;
default is 10.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be passed to <code><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></code> or
<code><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html" class="external-link">gamlss</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of PIT values if <code>return_fit = FALSE</code>, or, if <code>return_fit = TRUE</code>,
a list containing the estimated distribution function (<code>F_x</code>), its parameters
(<code>params</code>), and properties of the fit such as the AIC and
Kolmogorov-Smirnov goodness-of-fit statistic (<code>fit</code>). If the estimated distribution
function depends on covariates, then the <code>gamlss</code> model fit is returned as the
parameters.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Continuous data</strong></p>
<p>If \(X\) is a continuous random variable with cumulative distribution function (CDF)
\(F\), then the probability integral transform (PIT) \(F(X)\) is uniformly distributed
between 0 and 1. Given a vector \(x_{1}, \dots, x_{n}\) of realisations of \(X\),
<code>get_pit</code> produces an estimate \(\hat{F}\) of the CDF \(F\), and returns a
vector of PIT values corresponding to another set of realisations \(z_{1}, \dots, z_{N}\),
$$\hat{F}(z_{1}), \dots, \hat{F}(z_{n}).$$</p>
<p><code>x_ref</code> contains the values \(x_{1}, \dots, x_{n}\) from which the CDF estimate
\(\hat{F}\) is obtained. <code>x_new</code> contains the values \(z_{1}, \dots, z_{n}\)
from which the PIT values \(\hat{F}(z_{1}), \dots, \hat{F}(z_{n})\) are calculated.
By default, <code>x_ref</code> and <code>x_new</code> are the same, so that the PIT values are
calculated in-sample.</p>
<p>To estimate the distribution, <code>get_pit</code> calls <code><a href="fit_dist.html">fit_dist</a></code>. The arguments
<code>dist</code>, <code>method</code> and <code>n_thres</code> are
documented in detail in the corresponding help page.</p>
<p>To check that the chosen distribution adequately fits the data, the argument
<code>return_fit = TRUE</code> can be used to return the estimated parameters of the
distribution, as well as properties of the fit such as the AIC and a p-value
for the Kolmogorov-Smirnov goodness-of-fit test.</p>
<p><strong>Non-stationary distributions</strong></p>
<p>The estimated distribution can also be non-stationary, by depending on some predictor variables or covariates.
These predictors can be included via the arguments <code>preds_ref</code> and <code>preds_new</code>,
which should be data frames with a separate column for each predictor, and with
numbers of rows equal to the lengths of <code>x_ref</code> and <code>x_new</code>, respectively.
In this case, a Generalized Additive Model for Location, Scale, and Shape (GAMLSS) is
fit to <code>x_ref</code> using the predictors in <code>preds_ref</code>.
The PIT values corresponding to <code>x_new</code> are then calculated by applying the
estimated distribution with predictors <code>preds_new</code>.
If a non-stationary distribution is to be estimated, both <code>preds_ref</code> and
<code>preds_new</code> must be provided. By default, <code>preds_new</code> is assumed to be
the same as <code>preds_ref</code>, to align with <code>x_new</code> being the same as <code>x_ref</code>.</p>
<p><strong>Censored data</strong></p>
<p>If the random variable \(X\) is not continuous, the PIT will not be uniformly distributed.
A relevant case is when \(X\) is censored. For example, precipitation is censored below
at zero. This results in several PIT values being equal to \(F(0)\). The <code>lower</code>
and <code>upper</code> arguments to <code>get_pit</code> allow the user to specify the lower and upper
bounds at which the data is censored; the default is <code>lower = -Inf</code> and <code>upper = Inf</code>,
i.e. there is no censoring.</p>
<p>If the PIT values are used to construct standardised indices, this censoring can lead to
unintuitive index values.
To deal with censored data, it has been proposed to map the PIT values of the censored
values to a different constant \(c\); see references. For example, for precipitation, the PIT
values would become
$$F(X) \quad \text{if} \quad X &gt; 0,$$
$$c \quad \text{if} \quad X = 0.$$
The constant \(c\) can be chosen so that the PIT values satisfy some desired property.
For example, if \(F(X)\) is uniformly distributed between 0 and 1, then it has mean equal
to \(1/2\). Hence, \(c\) could be chosen such that the mean of the PIT values of the
censored distribution are equal to \(1/2\).
Alternatively, if \(F(X)\) is uniformly distributed between 0 and 1, then
the transformed PIT value \(\Phi^{-1}(F(X))\) (where \(\Phi^{-1}\) is the quantile function
of the standard normal distribution) follows a standard normal distribution, and therefore
has mean equal to 0. The constant \(c\) could therefore be chosen such that the mean of the
transformed PIT values of the censored distribution are equal to 0.</p>
<p>The argument <code>cens</code> in <code>get_pit</code> can be used to treat censored data. <code>cens</code>
can be one of four options: a single numeric value containing the value \(c\) at which to
assign the PIT values of the censored realisations; the string <code>'none'</code> if no censoring
is to be performed; the string <code>'prob'</code> if \(c\)
is to be chosen automatically so that the mean of the PIT values is equal to \(1/2\);
or the string <code>'normal'</code> if \(c\) is to be chosen automatically so that the mean of
the transformed PIT values is equal to 0. If the data is censored both above and below,
then <code>cens</code> must be a numeric vector of length two, specifying the values to assign
the realisations that are censored both below and above.</p>
<p>When the data is censored, <code>dist</code> corresponds to the distribution used to estimate the
uncensored realisations, e.g. positive precipitations. The probability of being at the boundary
points is estimated using the relative frequency of censored observations in <code>x_ref</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rigby, R. A., &amp; Stasinopoulos, D. M. (2005):
`Generalized additive models for location, scale and shape',
<em>Journal of the Royal Statistical Society Series C: Applied Statistics</em> 54, 507-554.
<a href="https://doi.org/10.1111/j.1467-9876.2005.00510.x" class="external-link">doi:10.1111/j.1467-9876.2005.00510.x</a></p>
<p>Stagge, J. H., Tallaksen, L. M., Gudmundsson, L., Van Loon, A. F., &amp; Stahl, K. (2015):
`Candidate distributions for climatological drought indices (SPI and SPEI)',
<em>International Journal of Climatology</em> 35, 4027-4040.
<a href="https://doi.org/10.1002/joc.4267" class="external-link">doi:10.1002/joc.4267</a></p>
<p>Allen, S. &amp; N. Otero (2023):
`Calculating standardised indices using SEI',
<em>EarthArXiv pre-print</em>.
<a href="https://doi.org/10.31223/X5GM4G" class="external-link">doi:10.31223/X5GM4G</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fit_dist.html">fit_dist</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sam Allen, Noelia Otero</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">rate</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># empirical distribution</span></span></span>
<span class="r-in"><span><span class="va">pit</span> <span class="op">&lt;-</span> <span class="fu">get_pit</span><span class="op">(</span><span class="va">x_ref</span>, <span class="va">x_new</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">pit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># gamma distribution</span></span></span>
<span class="r-in"><span><span class="va">pit</span> <span class="op">&lt;-</span> <span class="fu">get_pit</span><span class="op">(</span><span class="va">x_ref</span>, <span class="va">x_new</span>, dist <span class="op">=</span> <span class="st">"gamma"</span>, return_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">pit</span><span class="op">$</span><span class="va">pit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x_ref</span>, breaks <span class="op">=</span> <span class="fl">30</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>, <span class="va">pit</span><span class="op">$</span><span class="va">params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pit</span><span class="op">$</span><span class="va">params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># weibull distribution</span></span></span>
<span class="r-in"><span><span class="va">pit</span> <span class="op">&lt;-</span> <span class="fu">get_pit</span><span class="op">(</span><span class="va">x_ref</span>, <span class="va">x_new</span>, dist <span class="op">=</span> <span class="st">"weibull"</span>, return_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">pit</span><span class="op">$</span><span class="va">pit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x_ref</span>, breaks <span class="op">=</span> <span class="fl">30</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">dweibull</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>, <span class="va">pit</span><span class="op">$</span><span class="va">params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pit</span><span class="op">$</span><span class="va">params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># exponential distribution</span></span></span>
<span class="r-in"><span><span class="va">pit</span> <span class="op">&lt;-</span> <span class="fu">get_pit</span><span class="op">(</span><span class="va">x_ref</span>, <span class="va">x_new</span>, dist <span class="op">=</span> <span class="st">"exp"</span>, return_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">pit</span><span class="op">$</span><span class="va">pit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x_ref</span>, breaks <span class="op">=</span> <span class="fl">30</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>, <span class="va">pit</span><span class="op">$</span><span class="va">params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># gamma distribution with censoring</span></span></span>
<span class="r-in"><span><span class="va">x_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x_ref</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pit</span> <span class="op">&lt;-</span> <span class="fu">get_pit</span><span class="op">(</span><span class="va">x_ref</span>, dist <span class="op">=</span> <span class="st">"gamma"</span>, lower <span class="op">=</span> <span class="fl">0</span>, cens <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">pit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pit</span><span class="op">)</span> <span class="co"># = 1/2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5006377</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">pit</span><span class="op">)</span><span class="op">)</span> <span class="co"># != 0</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0624038</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pit</span> <span class="op">&lt;-</span> <span class="fu">get_pit</span><span class="op">(</span><span class="va">x_ref</span>, dist <span class="op">=</span> <span class="st">"gamma"</span>, lower <span class="op">=</span> <span class="fl">0</span>, cens <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">pit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pit</span><span class="op">)</span> <span class="co"># != 1/2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4818721</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">pit</span><span class="op">)</span><span class="op">)</span> <span class="co"># = 0</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0007063971</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## normal distribution with trend in mean</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">20</span>, length.out <span class="op">=</span> <span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">x</span> <span class="op">+</span> <span class="va">shape</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x_ref</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pit</span> <span class="op">&lt;-</span> <span class="fu">get_pit</span><span class="op">(</span><span class="va">x_ref</span>, preds_ref <span class="op">=</span> <span class="va">preds</span>, dist <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">pit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## normal distribution with trend in mean and standard deviation</span></span></span>
<span class="r-in"><span><span class="va">x_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">x</span> <span class="op">+</span> <span class="va">shape</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x_ref</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pit</span> <span class="op">&lt;-</span> <span class="fu">get_pit</span><span class="op">(</span><span class="va">x_ref</span>, preds_ref <span class="op">=</span> <span class="va">preds</span>, dist <span class="op">=</span> <span class="st">"norm"</span>, sigma.formula <span class="op">=</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">pit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_pit-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># sigma.formula is an optional argument in the gamlss::gamlss function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sam Allen, Noelia Otero.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

